<div class="map-wrapper">
  <agm-map [latitude]="geo.latitude" [longitude]="geo.longitude" [zoom]="geo.zoom" [fitBounds]="true">
    <agm-marker *ngFor="
        let event of events
          | eventsFilter: selectedCategories:selectedDateTimes:selectedGameNames
      " [latitude]="event.location.geo.latitude" [longitude]="event.location.geo.longitude"
      (markerClick)="highlightItem(event)" [iconUrl]="event === selectedEvent ? icons.active : icons.default"
      [agmFitBounds]="true">
      <div><i class="fa fa-truck" aria-hidden="true"></i></div>
      <agm-info-window>
        <app-small-event-item [event]="event"></app-small-event-item>
      </agm-info-window>
    </agm-marker>
  </agm-map>
</div>

<div class="container">
  <div class="filters-wrapp">
    <div class="row align-items-center">
      <div class="col-7">
        <div class="filters-category">
          <app-filter-category [categories]="categoriesCurrent" (toggle)="onCategoriesChange($event)">
          </app-filter-category>
        </div>
        <div class="filters-date">
          <app-filter-date [datesFormatted]="eventDateTimes" (toggle)="onDateTimeChange($event)"></app-filter-date>
        </div>
        <div class="filters-game-name">
          <app-filter-game-name [games]="gameName" (toggle)="onGameNameChange($event)"></app-filter-game-name>
        </div>
        <div class="md-form">
          <input type="search" [(ngModel)]="searchText" placeholder="Search by any text">
        </div>
        <!-- <h2 class="text-center mb-0">Some filters</h2> -->
      </div>

      <div class="col-5 text-center">
        <button class="create-event-btn" routerLinkActive="active" routerLink="/pageaddevent">
          Create an event
        </button>
      </div>
    </div>
  </div>

  <app-spinner *ngIf="loading"></app-spinner>
  <div class="event-list" *ngIf="!loading">
    <h2 class="panel-heading mb-5 pt-3">
      Upcomming Events
      <span *ngIf="selectedCategories.length">sorted by: {{ selectedCategories }}
      </span>
    </h2>

    <div class="eventsList row">
      <div class="col-xl-3 col-lg-4 col-sm-6" *ngFor="
          let event of events
            | eventsFilter
              : selectedCategories
              : selectedDateTimes
              : selectedGameNames
            | filter
              : searchText
        ">
        <app-event-item [event]="event" [ngClass]="{ selected: event === selectedEvent }"
          (click)="highlightItem(event)"></app-event-item>
      </div>
    </div>
  </div>
</div>

<div class="py-5"></div>
